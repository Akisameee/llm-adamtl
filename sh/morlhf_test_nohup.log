nohup: 忽略输入
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
(INFO) 2024-04-21 10:29:26,252 - MORLHF_test_logger:
Args Info:

Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
(INFO) 2024-04-21 10:29:32,948 - MORLHF_test_logger:
Peft Info:
total parameters: 1369744224
trainable parameters: 3146592
non-trainable parameters: 1366597632
(INFO) 2024-04-21 10:29:38,366 - MORLHF_test_logger:
Disabling target model peft layers as reference model.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
/home/smliu/RLHF/tests/test_morlhf.py:41: UserWarning: torch.range is deprecated and will be removed in a future release because its behavior is inconsistent with Python's range builtin. Instead, use torch.arange, which produces values in [start, end).
  x = torch.range(0, 1, step = 1 / (n_epoch - 1))
  0%|          | 0/2400 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
  0%|          | 1/2400 [00:01<1:15:45,  1.89s/it]  0%|          | 2/2400 [00:14<5:22:20,  8.07s/it]  0%|          | 3/2400 [00:14<3:05:48,  4.65s/it]  0%|          | 4/2400 [00:15<1:59:35,  2.99s/it]  0%|          | 5/2400 [00:15<1:23:43,  2.10s/it]  0%|          | 6/2400 [00:16<1:00:52,  1.53s/it]  0%|          | 7/2400 [00:18<1:04:18,  1.61s/it]  0%|          | 8/2400 [00:27<2:42:15,  4.07s/it]  0%|          | 9/2400 [00:37<3:58:16,  5.98s/it]  0%|          | 10/2400 [00:38<2:50:53,  4.29s/it]  0%|          | 11/2400 [00:38<2:05:48,  3.16s/it]  0%|          | 12/2400 [00:39<1:33:01,  2.34s/it]  1%|          | 13/2400 [00:39<1:10:11,  1.76s/it]  1%|          | 14/2400 [00:48<2:37:05,  3.95s/it]  1%|          | 15/2400 [00:48<1:55:01,  2.89s/it]  1%|          | 16/2400 [00:59<3:20:29,  5.05s/it]  1%|          | 17/2400 [01:04<3:24:17,  5.14s/it]  1%|          | 18/2400 [01:18<5:15:32,  7.95s/it]  1%|          | 19/2400 [01:24<4:50:35,  7.32s/it]  1%|          | 20/2400 [01:25<3:28:35,  5.26s/it]  1%|          | 21/2400 [01:39<5:16:24,  7.98s/it]  1%|          | 22/2400 [01:50<5:54:49,  8.95s/it]  1%|          | 23/2400 [01:51<4:15:41,  6.45s/it]  1%|          | 24/2400 [01:51<3:03:50,  4.64s/it]  1%|          | 25/2400 [01:52<2:13:32,  3.37s/it]  1%|          | 26/2400 [02:04<4:01:12,  6.10s/it]  1%|          | 27/2400 [02:05<2:55:11,  4.43s/it]  1%|          | 28/2400 [02:05<2:08:36,  3.25s/it]  1%|          | 29/2400 [02:06<1:34:54,  2.40s/it]  1%|▏         | 30/2400 [02:15<2:52:01,  4.35s/it]  1%|▏         | 31/2400 [02:28<4:38:32,  7.05s/it]  1%|▏         | 32/2400 [02:28<3:19:51,  5.06s/it]  1%|▏         | 33/2400 [02:38<4:10:00,  6.34s/it]  1%|▏         | 34/2400 [02:50<5:16:23,  8.02s/it]  1%|▏         | 35/2400 [03:00<5:45:13,  8.76s/it]  2%|▏         | 36/2400 [03:09<5:52:39,  8.95s/it]  2%|▏         | 37/2400 [03:21<6:19:12,  9.63s/it]  2%|▏         | 38/2400 [03:33<6:56:43, 10.59s/it]  2%|▏         | 39/2400 [03:47<7:28:26, 11.40s/it]  2%|▏         | 40/2400 [03:59<7:33:43, 11.54s/it]  2%|▏         | 41/2400 [04:10<7:30:36, 11.46s/it]  2%|▏         | 42/2400 [04:20<7:11:55, 10.99s/it]  2%|▏         | 43/2400 [04:35<7:57:31, 12.16s/it]  2%|▏         | 44/2400 [04:47<8:00:37, 12.24s/it]  2%|▏         | 45/2400 [04:48<5:43:32,  8.75s/it]  2%|▏         | 46/2400 [05:01<6:40:28, 10.21s/it]  2%|▏         | 47/2400 [05:02<4:45:51,  7.29s/it]  2%|▏         | 48/2400 [05:03<3:38:16,  5.57s/it]  2%|▏         | 49/2400 [05:19<5:31:36,  8.46s/it]  2%|▏         | 50/2400 [05:19<3:58:48,  6.10s/it]  2%|▏         | 51/2400 [05:29<4:37:01,  7.08s/it]  2%|▏         | 52/2400 [05:29<3:19:26,  5.10s/it]  2%|▏         | 53/2400 [05:38<4:01:09,  6.17s/it]  2%|▏         | 54/2400 [05:38<2:55:26,  4.49s/it]  2%|▏         | 55/2400 [05:52<4:45:56,  7.32s/it]  2%|▏         | 56/2400 [06:03<5:26:05,  8.35s/it]  2%|▏         | 57/2400 [06:15<6:14:57,  9.60s/it]