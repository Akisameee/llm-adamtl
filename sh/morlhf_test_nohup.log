nohup: 忽略输入
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
(INFO) 2024-04-22 00:37:21,846 - MORLHF_test_logger:
Args Info:

Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
(INFO) 2024-04-22 00:37:26,707 - MORLHF_test_logger:
Peft Info:
total parameters: 1369744224
trainable parameters: 3146592
non-trainable parameters: 1366597632
(INFO) 2024-04-22 00:37:27,476 - MORLHF_test_logger:
Disabling target model peft layers as reference model.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
/home/smliu/RLHF/tests/test_morlhf.py:41: UserWarning: torch.range is deprecated and will be removed in a future release because its behavior is inconsistent with Python's range builtin. Instead, use torch.arange, which produces values in [start, end).
  x = torch.range(0, 1, step = 1 / (n_epoch - 1))
  0%|          | 0/2400 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
  0%|          | 1/2400 [00:01<51:43,  1.29s/it]  0%|          | 2/2400 [00:02<49:44,  1.24s/it]  0%|          | 3/2400 [00:04<1:03:05,  1.58s/it]  0%|          | 4/2400 [00:05<53:11,  1.33s/it]    0%|          | 5/2400 [00:07<1:02:21,  1.56s/it]  0%|          | 6/2400 [00:08<53:05,  1.33s/it]    0%|          | 7/2400 [00:10<1:07:09,  1.68s/it]  0%|          | 8/2400 [00:21<2:58:47,  4.48s/it]  0%|          | 9/2400 [00:31<4:16:01,  6.42s/it]  0%|          | 10/2400 [00:32<3:07:43,  4.71s/it]  0%|          | 11/2400 [00:33<2:24:03,  3.62s/it]  0%|          | 12/2400 [00:34<1:50:12,  2.77s/it]  1%|          | 13/2400 [00:35<1:22:47,  2.08s/it]  1%|          | 14/2400 [00:44<2:51:12,  4.31s/it]  1%|          | 15/2400 [00:46<2:17:47,  3.47s/it]  1%|          | 16/2400 [00:50<2:27:37,  3.72s/it]  1%|          | 17/2400 [00:53<2:14:43,  3.39s/it]  1%|          | 18/2400 [01:08<4:35:10,  6.93s/it]  1%|          | 19/2400 [01:20<5:39:16,  8.55s/it]  1%|          | 20/2400 [01:21<4:08:14,  6.26s/it]  1%|          | 21/2400 [01:36<5:51:56,  8.88s/it]  1%|          | 22/2400 [01:48<6:27:05,  9.77s/it]  1%|          | 23/2400 [01:50<4:56:06,  7.47s/it]  1%|          | 24/2400 [01:51<3:36:54,  5.48s/it]  1%|          | 25/2400 [01:52<2:44:36,  4.16s/it]  1%|          | 26/2400 [01:54<2:18:27,  3.50s/it]  1%|          | 27/2400 [02:09<4:40:14,  7.09s/it]  1%|          | 28/2400 [02:10<3:26:13,  5.22s/it]  1%|          | 29/2400 [02:11<2:38:41,  4.02s/it]  1%|▏         | 30/2400 [02:21<3:41:57,  5.62s/it]  1%|▏         | 31/2400 [02:35<5:21:41,  8.15s/it]  1%|▏         | 32/2400 [02:36<3:57:52,  6.03s/it]  1%|▏         | 33/2400 [02:46<4:42:23,  7.16s/it]  1%|▏         | 34/2400 [02:47<3:29:30,  5.31s/it]  1%|▏         | 35/2400 [02:57<4:34:02,  6.95s/it]  2%|▏         | 36/2400 [03:07<5:06:08,  7.77s/it]  2%|▏         | 37/2400 [03:08<3:45:50,  5.73s/it]  2%|▏         | 38/2400 [03:22<5:16:51,  8.05s/it]  2%|▏         | 39/2400 [03:23<3:56:06,  6.00s/it]  2%|▏         | 40/2400 [03:35<5:12:36,  7.95s/it]  2%|▏         | 41/2400 [03:47<5:58:32,  9.12s/it]  2%|▏         | 42/2400 [03:58<6:15:01,  9.54s/it]  2%|▏         | 43/2400 [04:08<6:21:12,  9.70s/it]  2%|▏         | 44/2400 [04:21<7:00:56, 10.72s/it]  2%|▏         | 45/2400 [04:22<5:13:04,  7.98s/it]  2%|▏         | 46/2400 [04:37<6:27:48,  9.88s/it]  2%|▏         | 47/2400 [04:38<4:40:38,  7.16s/it]  2%|▏         | 48/2400 [04:49<5:34:02,  8.52s/it]  2%|▏         | 49/2400 [04:59<5:45:54,  8.83s/it]  2%|▏         | 50/2400 [05:00<4:15:58,  6.54s/it]  2%|▏         | 51/2400 [05:02<3:18:28,  5.07s/it]  2%|▏         | 52/2400 [05:03<2:31:32,  3.87s/it]  2%|▏         | 53/2400 [05:12<3:30:53,  5.39s/it]  2%|▏         | 54/2400 [05:13<2:49:31,  4.34s/it]  2%|▏         | 55/2400 [05:17<2:42:56,  4.17s/it]  2%|▏         | 56/2400 [05:19<2:19:33,  3.57s/it]  2%|▏         | 57/2400 [05:35<4:42:32,  7.24s/it]  2%|▏         | 58/2400 [05:48<5:47:28,  8.90s/it]  2%|▏         | 59/2400 [05:49<4:19:13,  6.64s/it]  2%|▎         | 60/2400 [05:51<3:17:11,  5.06s/it]  3%|▎         | 61/2400 [05:53<2:47:21,  4.29s/it]  3%|▎         | 62/2400 [05:54<2:06:02,  3.23s/it]  3%|▎         | 63/2400 [06:06<3:46:40,  5.82s/it]  3%|▎         | 64/2400 [06:16<4:37:58,  7.14s/it]  3%|▎         | 65/2400 [06:25<4:59:33,  7.70s/it]  3%|▎         | 66/2400 [06:26<3:42:41,  5.72s/it]  3%|▎         | 67/2400 [06:27<2:43:40,  4.21s/it]  3%|▎         | 68/2400 [06:37<3:47:59,  5.87s/it]  3%|▎         | 69/2400 [06:38<2:59:29,  4.62s/it]  3%|▎         | 70/2400 [06:54<5:04:31,  7.84s/it]  3%|▎         | 71/2400 [07:09<6:28:29, 10.01s/it]  3%|▎         | 72/2400 [07:10<4:51:00,  7.50s/it]  3%|▎         | 73/2400 [07:12<3:37:04,  5.60s/it]  3%|▎         | 74/2400 [07:23<4:46:50,  7.40s/it]  3%|▎         | 75/2400 [07:25<3:45:00,  5.81s/it]  3%|▎         | 76/2400 [07:26<2:50:28,  4.40s/it]  3%|▎         | 77/2400 [07:38<4:10:53,  6.48s/it]  3%|▎         | 78/2400 [07:40<3:17:47,  5.11s/it]  3%|▎         | 79/2400 [07:41<2:32:01,  3.93s/it]  3%|▎         | 80/2400 [07:44<2:23:54,  3.72s/it]  3%|▎         | 81/2400 [07:45<1:49:35,  2.84s/it]  3%|▎         | 82/2400 [07:59<3:56:29,  6.12s/it]  3%|▎         | 83/2400 [08:10<4:56:07,  7.67s/it]  4%|▎         | 84/2400 [08:36<8:24:53, 13.08s/it]  4%|▎         | 85/2400 [08:50<8:35:04, 13.35s/it]  4%|▎         | 86/2400 [08:52<6:27:52, 10.06s/it]  4%|▎         | 87/2400 [08:54<4:54:52,  7.65s/it]  4%|▎         | 88/2400 [09:07<5:56:30,  9.25s/it]  4%|▎         | 89/2400 [09:13<5:20:28,  8.32s/it]  4%|▍         | 90/2400 [09:18<4:36:52,  7.19s/it]  4%|▍         | 91/2400 [09:30<5:39:42,  8.83s/it]  4%|▍         | 92/2400 [09:32<4:16:34,  6.67s/it]  4%|▍         | 93/2400 [09:43<5:02:53,  7.88s/it]  4%|▍         | 94/2400 [09:55<5:51:16,  9.14s/it]  4%|▍         | 95/2400 [10:05<6:03:04,  9.45s/it]  4%|▍         | 96/2400 [10:15<6:15:34,  9.78s/it]  4%|▍         | 97/2400 [10:24<5:55:52,  9.27s/it]  4%|▍         | 98/2400 [10:33<5:56:01,  9.28s/it]  4%|▍         | 99/2400 [10:34<4:22:19,  6.84s/it]  4%|▍         | 100/2400 [10:35<3:19:16,  5.20s/it]  4%|▍         | 101/2400 [10:49<4:50:58,  7.59s/it]  4%|▍         | 102/2400 [10:57<5:03:47,  7.93s/it]  4%|▍         | 103/2400 [11:08<5:34:29,  8.74s/it]  4%|▍         | 104/2400 [11:09<4:03:24,  6.36s/it]  4%|▍         | 105/2400 [11:10<3:07:51,  4.91s/it]  4%|▍         | 106/2400 [11:11<2:20:13,  3.67s/it]  4%|▍         | 107/2400 [11:15<2:18:57,  3.64s/it]  4%|▍         | 108/2400 [11:16<1:49:59,  2.88s/it]  5%|▍         | 109/2400 [11:26<3:14:29,  5.09s/it]  5%|▍         | 110/2400 [11:36<4:11:59,  6.60s/it]  5%|▍         | 111/2400 [11:37<3:09:26,  4.97s/it]  5%|▍         | 112/2400 [11:51<4:52:39,  7.67s/it]  5%|▍         | 113/2400 [11:53<3:44:07,  5.88s/it]  5%|▍         | 114/2400 [12:09<5:41:25,  8.96s/it]  5%|▍         | 115/2400 [12:20<6:09:26,  9.70s/it]  5%|▍         | 116/2400 [12:32<6:28:07, 10.20s/it]  5%|▍         | 117/2400 [12:37<5:25:22,  8.55s/it]  5%|▍         | 118/2400 [12:38<4:04:22,  6.43s/it]  5%|▍         | 119/2400 [12:49<4:56:30,  7.80s/it]  5%|▌         | 120/2400 [13:01<5:48:30,  9.17s/it]  5%|▌         | 121/2400 [13:04<4:33:27,  7.20s/it]  5%|▌         | 122/2400 [13:19<6:04:59,  9.61s/it]  5%|▌         | 123/2400 [13:30<6:20:19, 10.02s/it]  5%|▌         | 124/2400 [13:39<6:10:45,  9.77s/it]  5%|▌         | 125/2400 [13:50<6:18:56,  9.99s/it]  5%|▌         | 126/2400 [13:51<4:38:52,  7.36s/it]  5%|▌         | 127/2400 [13:53<3:35:10,  5.68s/it]  5%|▌         | 128/2400 [14:05<4:53:07,  7.74s/it]  5%|▌         | 129/2400 [14:15<5:11:59,  8.24s/it]  5%|▌         | 130/2400 [14:27<5:52:25,  9.32s/it]  5%|▌         | 131/2400 [14:28<4:17:52,  6.82s/it]  6%|▌         | 132/2400 [14:29<3:20:18,  5.30s/it]  6%|▌         | 133/2400 [14:32<2:45:25,  4.38s/it]  6%|▌         | 134/2400 [14:41<3:39:57,  5.82s/it]  6%|▌         | 135/2400 [14:51<4:25:03,  7.02s/it]  6%|▌         | 136/2400 [15:02<5:09:29,  8.20s/it]  6%|▌         | 137/2400 [15:16<6:16:23,  9.98s/it]  6%|▌         | 138/2400 [15:17<4:38:54,  7.40s/it]  6%|▌         | 139/2400 [15:19<3:36:15,  5.74s/it]  6%|▌         | 140/2400 [15:20<2:42:15,  4.31s/it]  6%|▌         | 141/2400 [15:35<4:46:35,  7.61s/it]  6%|▌         | 142/2400 [15:49<6:00:26,  9.58s/it]