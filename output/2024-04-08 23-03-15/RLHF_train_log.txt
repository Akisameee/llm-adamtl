(INFO) 2024-04-08 23:03:15,926  - RLHF_train_logger:
<class 'trl.models.modeling_value_head.AutoModelForCausalLMWithValueHead'> Peft Info:
total parameters: 248344577
trainable parameters: 319488
non-trainable parameters: 248025089
(INFO) 2024-04-08 23:03:20,532  - RLHF_train_logger:
Episode: 1 Timestep: 8
policy_loss: -0.01117 critic_loss: 0.244 rm_score: -5.601 ref_kl: 0 generate_length: 71.75
(INFO) 2024-04-08 23:03:24,029  - RLHF_train_logger:
Episode: 1 Timestep: 16
policy_loss: -0.007002 critic_loss: 0.204 rm_score: -4.15 ref_kl: 5.018e-05 generate_length: 61.38
(INFO) 2024-04-08 23:03:27,136  - RLHF_train_logger:
Episode: 1 Timestep: 24
policy_loss: -0.005612 critic_loss: 0.2134 rm_score: -4.69 ref_kl: 0.0002378 generate_length: 58.25
(INFO) 2024-04-08 23:03:31,233  - RLHF_train_logger:
Episode: 1 Timestep: 32
policy_loss: -0.003049 critic_loss: 0.1888 rm_score: -5.454 ref_kl: -0.0001152 generate_length: 91.12
(INFO) 2024-04-08 23:03:34,368  - RLHF_train_logger:
Episode: 1 Timestep: 40
policy_loss: -0.004215 critic_loss: 0.2463 rm_score: -4.984 ref_kl: 0.0002588 generate_length: 58.12
(INFO) 2024-04-08 23:03:37,274  - RLHF_train_logger:
Episode: 1 Timestep: 48
policy_loss: -0.003784 critic_loss: 0.2703 rm_score: -5.267 ref_kl: -0.0004631 generate_length: 58.12
(INFO) 2024-04-08 23:03:40,790  - RLHF_train_logger:
Episode: 1 Timestep: 56
policy_loss: -0.006666 critic_loss: 0.1778 rm_score: -3.433 ref_kl: -0.0001581 generate_length: 52.25
(INFO) 2024-04-08 23:03:45,468  - RLHF_train_logger:
Episode: 1 Timestep: 64
policy_loss: -0.002651 critic_loss: 0.1541 rm_score: -5.366 ref_kl: -0.0003089 generate_length: 99.5
(INFO) 2024-04-08 23:03:50,292  - RLHF_train_logger:
Episode: 1 Timestep: 72
policy_loss: -0.004557 critic_loss: 0.2269 rm_score: -5.145 ref_kl: 4.707e-05 generate_length: 73.88
(INFO) 2024-04-08 23:03:53,853  - RLHF_train_logger:
Episode: 1 Timestep: 80
policy_loss: -0.005564 critic_loss: 0.2037 rm_score: -5.164 ref_kl: -0.0007399 generate_length: 69.25
(INFO) 2024-04-08 23:03:57,391  - RLHF_train_logger:
Episode: 1 Timestep: 88
policy_loss: -0.004385 critic_loss: 0.2302 rm_score: -6.01 ref_kl: -0.0004007 generate_length: 77.88
(INFO) 2024-04-08 23:04:01,864  - RLHF_train_logger:
Episode: 1 Timestep: 96
policy_loss: -0.003969 critic_loss: 0.1837 rm_score: -5.601 ref_kl: -0.0003195 generate_length: 91.25
(INFO) 2024-04-08 23:04:04,703  - RLHF_train_logger:
Episode: 1 Timestep: 104
policy_loss: -0.004411 critic_loss: 0.2229 rm_score: -5.268 ref_kl: 0.000232 generate_length: 65.5
(INFO) 2024-04-08 23:04:09,364  - RLHF_train_logger:
Episode: 1 Timestep: 112
policy_loss: -0.004612 critic_loss: 0.151 rm_score: -4.934 ref_kl: -0.0005199 generate_length: 92
(INFO) 2024-04-08 23:04:12,973  - RLHF_train_logger:
Episode: 1 Timestep: 120
policy_loss: -0.006228 critic_loss: 0.2069 rm_score: -3.799 ref_kl: -0.000332 generate_length: 50.75
(INFO) 2024-04-08 23:04:16,534  - RLHF_train_logger:
Episode: 1 Timestep: 128
policy_loss: -0.004525 critic_loss: 0.1874 rm_score: -5.308 ref_kl: -0.0003624 generate_length: 74
(INFO) 2024-04-08 23:04:18,875  - RLHF_train_logger:
Episode: 1 Timestep: 136
policy_loss: -0.008366 critic_loss: 0.2723 rm_score: -5.515 ref_kl: -0.001253 generate_length: 53.5
(INFO) 2024-04-08 23:04:23,217  - RLHF_train_logger:
Episode: 1 Timestep: 144
policy_loss: -0.00462 critic_loss: 0.1731 rm_score: -5.836 ref_kl: -0.002006 generate_length: 91.5
(INFO) 2024-04-08 23:04:26,631  - RLHF_train_logger:
Episode: 1 Timestep: 152
policy_loss: -0.006669 critic_loss: 0.2003 rm_score: -5.967 ref_kl: -0.001977 generate_length: 69.75
(INFO) 2024-04-08 23:04:30,432  - RLHF_train_logger:
Episode: 2 Timestep: 160
policy_loss: -0.004716 critic_loss: 0.1765 rm_score: -5.262 ref_kl: -0.003553 generate_length: 73.38
(INFO) 2024-04-08 23:04:34,929  - RLHF_train_logger:
Episode: 2 Timestep: 168
policy_loss: -0.005165 critic_loss: 0.1351 rm_score: -5.336 ref_kl: -0.002795 generate_length: 95.12
(INFO) 2024-04-08 23:04:37,091  - RLHF_train_logger:
Episode: 2 Timestep: 176
policy_loss: -0.01125 critic_loss: 0.2109 rm_score: -5.161 ref_kl: -0.002728 generate_length: 46
(INFO) 2024-04-08 23:04:40,610  - RLHF_train_logger:
Episode: 2 Timestep: 184
policy_loss: -0.008301 critic_loss: 0.1594 rm_score: -5.827 ref_kl: -0.007743 generate_length: 74.38
(INFO) 2024-04-08 23:04:43,231  - RLHF_train_logger:
Episode: 2 Timestep: 192
policy_loss: -0.009634 critic_loss: 0.1751 rm_score: -4.804 ref_kl: -0.004755 generate_length: 59.5
(INFO) 2024-04-08 23:04:45,464  - RLHF_train_logger:
Episode: 2 Timestep: 200
policy_loss: -0.01831 critic_loss: 0.1646 rm_score: -4.116 ref_kl: -0.004955 generate_length: 37.12
(INFO) 2024-04-08 23:04:49,092  - RLHF_train_logger:
Episode: 2 Timestep: 208
policy_loss: -0.007756 critic_loss: 0.1279 rm_score: -5.95 ref_kl: -0.008709 generate_length: 82
(INFO) 2024-04-08 23:04:53,725  - RLHF_train_logger:
Episode: 2 Timestep: 216
policy_loss: -0.009028 critic_loss: 0.1179 rm_score: -5.245 ref_kl: -0.01667 generate_length: 84.5
(INFO) 2024-04-08 23:04:57,084  - RLHF_train_logger:
Episode: 2 Timestep: 224
policy_loss: -0.007697 critic_loss: 0.1185 rm_score: -5.582 ref_kl: -0.01327 generate_length: 77.5
(INFO) 2024-04-08 23:05:00,669  - RLHF_train_logger:
Episode: 2 Timestep: 232
policy_loss: -0.007493 critic_loss: 0.1097 rm_score: -5.585 ref_kl: -0.01498 generate_length: 87
(INFO) 2024-04-08 23:05:04,387  - RLHF_train_logger:
Episode: 2 Timestep: 240
policy_loss: -0.01041 critic_loss: 0.09556 rm_score: -5.179 ref_kl: -0.01281 generate_length: 78.12
(INFO) 2024-04-08 23:05:08,298  - RLHF_train_logger:
Episode: 2 Timestep: 248
policy_loss: -0.009468 critic_loss: 0.07956 rm_score: -5.557 ref_kl: -0.02208 generate_length: 93
(INFO) 2024-04-08 23:05:11,671  - RLHF_train_logger:
Episode: 2 Timestep: 256
policy_loss: -0.01181 critic_loss: 0.09114 rm_score: -5.217 ref_kl: -0.02231 generate_length: 71.88
(INFO) 2024-04-08 23:05:16,237  - RLHF_train_logger:
Episode: 2 Timestep: 264
policy_loss: -0.007322 critic_loss: 0.09869 rm_score: -5.439 ref_kl: -0.02844 generate_length: 109.5
(INFO) 2024-04-08 23:05:20,400  - RLHF_train_logger:
Episode: 2 Timestep: 272
policy_loss: -0.008672 critic_loss: 0.1426 rm_score: -6.172 ref_kl: -0.02974 generate_length: 72.5
(INFO) 2024-04-08 23:05:23,794  - RLHF_train_logger:
Episode: 2 Timestep: 280
policy_loss: -0.01026 critic_loss: 0.09178 rm_score: -5.374 ref_kl: -0.01869 generate_length: 71.5
(INFO) 2024-04-08 23:05:26,757  - RLHF_train_logger:
Episode: 2 Timestep: 288
policy_loss: -0.01452 critic_loss: 0.1116 rm_score: -4.848 ref_kl: -0.02816 generate_length: 46.5
(INFO) 2024-04-08 23:05:31,172  - RLHF_train_logger:
Episode: 2 Timestep: 296
policy_loss: -0.00874 critic_loss: 0.08624 rm_score: -6.011 ref_kl: -0.02475 generate_length: 101.5
(INFO) 2024-04-08 23:05:34,175  - RLHF_train_logger:
Episode: 2 Timestep: 304
policy_loss: -0.01887 critic_loss: 0.1045 rm_score: -5.656 ref_kl: -0.03589 generate_length: 58
(INFO) 2024-04-08 23:05:37,981  - accelerate.accelerator:
The used dataset had no length, returning gathered tensors. You should drop the remainder yourself.
(INFO) 2024-04-08 23:05:37,982  - RLHF_train_logger:
Episode: 2 Timestep: 312
policy_loss: -0.01025 critic_loss: 0.123 rm_score: -6.132 ref_kl: -0.03438 generate_length: 66.5
(INFO) 2024-04-08 23:05:41,963  - RLHF_train_logger:
Episode: 3 Timestep: 320
policy_loss: -0.009102 critic_loss: 0.1023 rm_score: -6.341 ref_kl: -0.02626 generate_length: 87.5
(INFO) 2024-04-08 23:05:46,532  - RLHF_train_logger:
Episode: 3 Timestep: 328
policy_loss: -0.007157 critic_loss: 0.09006 rm_score: -5.031 ref_kl: -0.03401 generate_length: 112
(INFO) 2024-04-08 23:05:51,507  - RLHF_train_logger:
Episode: 3 Timestep: 336
policy_loss: -0.0124 critic_loss: 0.1399 rm_score: -4.59 ref_kl: -0.04467 generate_length: 100
(INFO) 2024-04-08 23:05:53,672  - RLHF_train_logger:
Episode: 3 Timestep: 344
policy_loss: -0.01863 critic_loss: 0.1221 rm_score: -5.356 ref_kl: -0.02842 generate_length: 46
(INFO) 2024-04-08 23:05:56,055  - RLHF_train_logger:
Episode: 3 Timestep: 352
policy_loss: -0.01379 critic_loss: 0.1191 rm_score: -5.1 ref_kl: -0.03259 generate_length: 50
(INFO) 2024-04-08 23:06:00,455  - RLHF_train_logger:
Episode: 3 Timestep: 360
policy_loss: -0.01102 critic_loss: 0.09554 rm_score: -5.767 ref_kl: -0.04446 generate_length: 90.5
(INFO) 2024-04-08 23:06:03,814  - RLHF_train_logger:
Episode: 3 Timestep: 368
policy_loss: -0.01511 critic_loss: 0.102 rm_score: -5.538 ref_kl: -0.04944 generate_length: 75
(INFO) 2024-04-08 23:06:07,648  - RLHF_train_logger:
Episode: 3 Timestep: 376
policy_loss: -0.008767 critic_loss: 0.09267 rm_score: -6.03 ref_kl: -0.02334 generate_length: 83
(INFO) 2024-04-08 23:06:12,392  - RLHF_train_logger:
Episode: 3 Timestep: 384
policy_loss: -0.007882 critic_loss: 0.09018 rm_score: -5.388 ref_kl: -0.02118 generate_length: 110
(INFO) 2024-04-08 23:06:16,982  - RLHF_train_logger:
Episode: 3 Timestep: 392
policy_loss: -0.00748 critic_loss: 0.1245 rm_score: -6.142 ref_kl: -0.03351 generate_length: 114
(INFO) 2024-04-08 23:06:20,165  - RLHF_train_logger:
Episode: 3 Timestep: 400
policy_loss: -0.009106 critic_loss: 0.1012 rm_score: -5.319 ref_kl: -0.03421 generate_length: 65
(INFO) 2024-04-08 23:06:24,415  - RLHF_train_logger:
Episode: 3 Timestep: 408
policy_loss: -0.006596 critic_loss: 0.09997 rm_score: -5.678 ref_kl: -0.02588 generate_length: 98
(INFO) 2024-04-08 23:06:29,307  - RLHF_train_logger:
Episode: 3 Timestep: 416
policy_loss: -0.00603 critic_loss: 0.08352 rm_score: -5.201 ref_kl: -0.02002 generate_length: 120.5
(INFO) 2024-04-08 23:06:33,023  - RLHF_train_logger:
Episode: 3 Timestep: 424
policy_loss: -0.01271 critic_loss: 0.114 rm_score: -4.672 ref_kl: -0.02459 generate_length: 64
(INFO) 2024-04-08 23:06:35,979  - RLHF_train_logger:
Episode: 3 Timestep: 432
policy_loss: -0.01737 critic_loss: 0.07129 rm_score: -5.396 ref_kl: -0.02594 generate_length: 43.38
(INFO) 2024-04-08 23:06:39,806  - RLHF_train_logger:
Episode: 3 Timestep: 440
policy_loss: -0.006048 critic_loss: 0.1117 rm_score: -4.57 ref_kl: -0.02185 generate_length: 84
(INFO) 2024-04-08 23:06:44,139  - RLHF_train_logger:
Episode: 3 Timestep: 448
policy_loss: -0.007287 critic_loss: 0.07391 rm_score: -6.063 ref_kl: -0.02602 generate_length: 98
(INFO) 2024-04-08 23:06:47,879  - RLHF_train_logger:
Episode: 3 Timestep: 456
policy_loss: -0.01045 critic_loss: 0.08631 rm_score: -5.613 ref_kl: -0.02264 generate_length: 65
(INFO) 2024-04-08 23:06:51,654  - RLHF_train_logger:
Episode: 3 Timestep: 464
policy_loss: -0.006339 critic_loss: 0.09641 rm_score: -6.066 ref_kl: -0.02573 generate_length: 83.5
(INFO) 2024-04-08 23:06:55,087  - RLHF_train_logger:
Episode: 4 Timestep: 472
policy_loss: -0.006464 critic_loss: 0.1069 rm_score: -5.169 ref_kl: -0.02337 generate_length: 75.38
(INFO) 2024-04-08 23:06:58,411  - RLHF_train_logger:
Episode: 4 Timestep: 480
policy_loss: -0.007716 critic_loss: 0.07943 rm_score: -5.726 ref_kl: -0.0219 generate_length: 79.5
(INFO) 2024-04-08 23:07:02,307  - RLHF_train_logger:
Episode: 4 Timestep: 488
policy_loss: -0.007001 critic_loss: 0.1005 rm_score: -5.873 ref_kl: -0.02253 generate_length: 89.5
(INFO) 2024-04-08 23:07:05,362  - RLHF_train_logger:
Episode: 4 Timestep: 496
policy_loss: -0.009125 critic_loss: 0.08621 rm_score: -5.133 ref_kl: -0.02107 generate_length: 71.5
(INFO) 2024-04-08 23:07:08,357  - RLHF_train_logger:
Episode: 4 Timestep: 504
policy_loss: -0.008354 critic_loss: 0.09661 rm_score: -5.185 ref_kl: -0.02564 generate_length: 69.5
(INFO) 2024-04-08 23:07:10,555  - RLHF_train_logger:
Episode: 4 Timestep: 512
policy_loss: -0.01225 critic_loss: 0.07488 rm_score: -5.064 ref_kl: -0.01668 generate_length: 38.62
(INFO) 2024-04-08 23:07:15,677  - RLHF_train_logger:
Episode: 4 Timestep: 520
policy_loss: -0.006422 critic_loss: 0.1053 rm_score: -4.725 ref_kl: -0.02298 generate_length: 98.25
(INFO) 2024-04-08 23:07:20,206  - RLHF_train_logger:
Episode: 4 Timestep: 528
policy_loss: -0.008543 critic_loss: 0.09579 rm_score: -5.205 ref_kl: -0.02243 generate_length: 83
(INFO) 2024-04-08 23:07:23,022  - RLHF_train_logger:
Episode: 4 Timestep: 536
policy_loss: -0.01116 critic_loss: 0.08962 rm_score: -4.477 ref_kl: -0.02218 generate_length: 50.62
(INFO) 2024-04-08 23:07:28,132  - RLHF_train_logger:
Episode: 4 Timestep: 544
policy_loss: -0.00664 critic_loss: 0.08246 rm_score: -6.348 ref_kl: -0.02006 generate_length: 117.5
(INFO) 2024-04-08 23:07:32,947  - RLHF_train_logger:
Episode: 4 Timestep: 552
policy_loss: -0.005237 critic_loss: 0.09449 rm_score: -6.396 ref_kl: -0.02891 generate_length: 109.5
(INFO) 2024-04-08 23:07:38,725  - RLHF_train_logger:
Episode: 4 Timestep: 560
policy_loss: -0.006005 critic_loss: 0.08274 rm_score: -6.025 ref_kl: -0.01789 generate_length: 105.2
(INFO) 2024-04-08 23:07:41,105  - RLHF_train_logger:
Episode: 4 Timestep: 568
policy_loss: -0.01545 critic_loss: 0.109 rm_score: -5.26 ref_kl: -0.02543 generate_length: 46.5
(INFO) 2024-04-08 23:07:45,261  - RLHF_train_logger:
Episode: 4 Timestep: 576
policy_loss: -0.005573 critic_loss: 0.1202 rm_score: -4.797 ref_kl: -0.02102 generate_length: 100
(INFO) 2024-04-08 23:07:50,200  - RLHF_train_logger:
Episode: 4 Timestep: 584
policy_loss: -0.007785 critic_loss: 0.08313 rm_score: -5.556 ref_kl: -0.02081 generate_length: 88.88
(INFO) 2024-04-08 23:07:53,318  - RLHF_train_logger:
Episode: 4 Timestep: 592
policy_loss: -0.01035 critic_loss: 0.1126 rm_score: -5.759 ref_kl: -0.0275 generate_length: 73
(INFO) 2024-04-08 23:07:55,383  - RLHF_train_logger:
Episode: 4 Timestep: 600
policy_loss: -0.01268 critic_loss: 0.09844 rm_score: -4.602 ref_kl: -0.0222 generate_length: 35.5
(INFO) 2024-04-08 23:07:59,622  - RLHF_train_logger:
Episode: 4 Timestep: 608
policy_loss: -0.008308 critic_loss: 0.09503 rm_score: -5.024 ref_kl: -0.01932 generate_length: 76.5
(INFO) 2024-04-08 23:08:03,383  - RLHF_train_logger:
Episode: 4 Timestep: 616
policy_loss: -0.007439 critic_loss: 0.08399 rm_score: -5.576 ref_kl: -0.02384 generate_length: 81.5
(INFO) 2024-04-08 23:08:06,724  - accelerate.accelerator:
The used dataset had no length, returning gathered tensors. You should drop the remainder yourself.
(INFO) 2024-04-08 23:08:06,725  - RLHF_train_logger:
Episode: 4 Timestep: 624
policy_loss: -0.007379 critic_loss: 0.06843 rm_score: -4.927 ref_kl: -0.02076 generate_length: 74.5
(INFO) 2024-04-08 23:08:09,528  - RLHF_train_logger:
Episode: 5 Timestep: 632
policy_loss: -0.009594 critic_loss: 0.1029 rm_score: -5.22 ref_kl: -0.01141 generate_length: 54.62
(INFO) 2024-04-08 23:08:13,615  - RLHF_train_logger:
Episode: 5 Timestep: 640
policy_loss: -0.007119 critic_loss: 0.0981 rm_score: -5.49 ref_kl: -0.01739 generate_length: 62.5
(INFO) 2024-04-08 23:08:16,658  - RLHF_train_logger:
Episode: 5 Timestep: 648
policy_loss: -0.01298 critic_loss: 0.08099 rm_score: -5.227 ref_kl: -0.0254 generate_length: 51.88
(INFO) 2024-04-08 23:08:19,806  - RLHF_train_logger:
Episode: 5 Timestep: 656
policy_loss: -0.009203 critic_loss: 0.08316 rm_score: -5.081 ref_kl: -0.02152 generate_length: 70.5
(INFO) 2024-04-08 23:08:22,445  - RLHF_train_logger:
Episode: 5 Timestep: 664
policy_loss: -0.01171 critic_loss: 0.07299 rm_score: -4.523 ref_kl: -0.02511 generate_length: 59.5
